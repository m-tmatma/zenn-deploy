---
title: "docker image ã®ãƒ“ãƒ«ãƒ‰ã«å¤±æ•—ã™ã‚‹ (Temporary failure resolving ...)"
emoji: "ğŸƒ"
type: "tech"
topics:
  - "docker"
published: true
published_at: "2023-05-21 10:32"
---

Ubuntu 22.04.2 LTS Server ã«ãŠã„ã¦ docker image ã®ãƒ“ãƒ«ãƒ‰ã«å¤±æ•—ã—ãŸã®ã§å¯¾ç­–æ–¹æ³•ã®ãƒ¡ãƒ¢

## çµè«–

`docker build --network host` ã®ã‚ˆã†ã« `--network host` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã€‚

ã“ã‚“ãªæ„Ÿã˜

```
docker build --network host -t docker-test:1 ./docker-conf
```

## å¯¾ç­–ã‚’ã—ãªã„ã¨ãã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```
$ docker build -t ....
         ç•¥

 ---> Running in 709bc69a12ae
Err:1 http://archive.ubuntu.com/ubuntu bionic InRelease
  Temporary failure resolving 'archive.ubuntu.com'
Err:2 http://security.ubuntu.com/ubuntu bionic-security InRelease
  Temporary failure resolving 'security.ubuntu.com'
Err:3 http://archive.ubuntu.com/ubuntu bionic-updates InRelease
  Temporary failure resolving 'archive.ubuntu.com'
Err:4 http://archive.ubuntu.com/ubuntu bionic-backports InRelease
  Temporary failure resolving 'archive.ubuntu.com'
Reading package lists...
W: Failed to fetch http://archive.ubuntu.com/ubuntu/dists/bionic/InRelease  Temporary failure resolving 'archive.ubuntu.com'
W: Failed to fetch http://archive.ubuntu.com/ubuntu/dists/bionic-updates/InRelease  Temporary failure resolving 'archive.ubuntu.com'
W: Failed to fetch http://archive.ubuntu.com/ubuntu/dists/bionic-backports/InRelease  Temporary failure resolving 'archive.ubuntu.com'
W: Failed to fetch http://security.ubuntu.com/ubuntu/dists/bionic-security/InRelease  Temporary failure resolving 'security.ubuntu.com'
W: Some index files failed to download. They have been ignored, or old ones used instead.

     ç•¥
```

## èª¬æ˜

### ãƒ›ã‚¹ãƒˆã® DNS è¨­å®šã€€è¨­å®šç¢ºèª

```
$ cat /etc/resolv.conf
   çœç•¥
nameserver 127.0.0.53
options edns0 trust-ad
search .
```

### `/etc/resolv.conf` ã®æ›¸ãæ›ãˆã€€ã†ã¾ãã„ã‹ãªã„æ–¹æ³•

`nameserver 8.8.8.8` ã®ã‚ˆã†ã« DNS ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã§ã¯ãªãã€å¤–éƒ¨ã® DNS ã‚µãƒ¼ãƒãƒ¼ã«æ›¸ãæ›ãˆã¦ã¿ãŸã€‚

â†’ `/etc/resolv.conf` ãŒã„ã¤ã®é–“ã«ã‹æ›¸ãæˆ»ã•ã‚Œã‚‹ã€‚

### `docker build` ã« `--network host` ã‚’æŒ‡å®šã™ã‚‹ã€‚ã€€ã†ã¾ãã„ãæ–¹æ³•

`docker build` ã«ã¯ `--dns` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒãªã„ã®ã§  `--network host` ã‚’æŒ‡å®šã—ã¦
ãƒ›ã‚¹ãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã†ã€‚

https://docs.docker.jp/network/host.html

## å‚è€ƒ

* https://kazuhira-r.hatenablog.com/entry/2020/04/12/194225 (ã“ã‚ŒãŒã†ã¾ãã„ã£ãŸ)
* https://rabbitfoot141.hatenablog.com/entry/2018/11/22/191858 (ã“ã‚Œã§ã¯å‹•ã‹ãªã‹ã£ãŸã€‚`/etc/resolv.conf` ãŒæ›¸ãæˆ»ã•ã‚Œã‚‹ã€‚)
* https://docs.docker.jp/network/host.html