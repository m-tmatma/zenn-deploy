---
title: "pytest ã«ã‚ˆã‚‹ parametrize ãƒ†ã‚¹ãƒˆ (ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‹•çš„ç”Ÿæˆ)"
emoji: "ğŸ·"
type: "tech"
topics:
  - "pytest"
published: true
published_at: "2022-06-25 13:31"
---

# pytest ã«ã‚ˆã‚‹ parametrize ãƒ†ã‚¹ãƒˆ (ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‹•çš„ç”Ÿæˆ)

## å›ºå®šå€¤ã«ã‚ˆã‚‹ parametrizeãƒ†ã‚¹ãƒˆ

ã‚ã‚‰ã‹ã˜ã‚æ±ºã‚ã‚‰ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ parametrizeãƒ†ã‚¹ãƒˆã‚’è¡Œã†å ´åˆã€å˜ã« `@pytest.mark.parametrize` (`parametrize`ã®`t`ã¨`r`ã®é–“ã« `e` ãŒãªã„ã®ãŒæ­£ã—ã„ã§ã™) ã‚’ã¤ã‘ã¦å¼•æ•°æŒ‡å®šã‚’ã™ã‚Œã°ã„ã„ã€‚å›ºå®šå€¤ã®å ´åˆã€æ¤œç´¢ã™ã‚Œã°ä¾‹ãŒè¦‹ã¤ã‹ã‚‹ã€‚

å‚è€ƒ:

https://docs.pytest.org/en/6.2.x/parametrize.html#pytest-mark-parametrize


## å‹•çš„ç”Ÿæˆã—ãŸ parametrizeãƒ†ã‚¹ãƒˆ

å‹•çš„ã«ç”Ÿæˆ (æ­£ç¢ºã«ã¯é–¢æ•°ã§ç”Ÿæˆ) ã—ã¦ parametrizeãƒ†ã‚¹ãƒˆã—ãŸã„å ´åˆã€é–¢æ•°å´ã§å€¤ã‚’ yield ã§è¿”ã™ã€‚

### ãƒ†ã‚¹ãƒˆåã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒãªã„å ´åˆ

ãƒ†ã‚¹ãƒˆåã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒãªã„å ´åˆã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãã®ã¾ã¾ yield ã™ã‚‹ã€‚

1. `@pytest.mark.parametrize` ã§æŒ‡å®šã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«é–¢æ•° ( ã“ã“ã§ã¯ã€`dynamic_params1()`) ã‚’æ¸¡ã™ã€‚
2. ãã®é–¢æ•°ã®ä¸­ã§ã€ä½¿ç”¨ã—ãŸã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ yield ã§è¿”ã™ã€‚

```
import pytest

def dynamic_params1():
    for i in range(3):
        for j in ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]:
            yield i, j

@pytest.mark.parametrize("i, j, ", dynamic_params1())
def test_dynamic_params1(i, j):
    print(i, j)
```


### ãƒ†ã‚¹ãƒˆåã‚’æŒ‡å®šã—ãŸã„å ´åˆ

ãƒ†ã‚¹ãƒˆåã‚’æŒ‡å®šã—ãŸã„å ´åˆ`pytest.param` ã§åŒ…ã‚“ã§ yield ã™ã‚‹ã€‚

1. `@pytest.mark.parametrize` ã§æŒ‡å®šã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«é–¢æ•° ( ã“ã“ã§ã¯ã€`dynamic_params2()`) ã‚’æ¸¡ã™ã€‚
2. ãã®é–¢æ•°ã®ä¸­ã§ã€ä½¿ç”¨ã—ãŸã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ `pytest.param` ã§åŒ…ã‚“ã§ yield ã™ã‚Œã°ã„ã„ã€‚
3. ã“ã®éš›ã€`id` ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹ã“ã¨ã§ãƒ†ã‚¹ãƒˆåã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

```
import pytest

def dynamic_params2():
    for i in range(3):
        for j in ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]:
            yield pytest.param(i, j, id=f"{i}-{j}-hogehoge")

@pytest.mark.parametrize("i, j, ", dynamic_params2())
def test_dynamic_params2(i, j):
    print(i, j)
```

### æƒ…å ±å…ƒ

#### è‹±èª

`Python Testing With Pytest: Simple, Rapid, Effective, and Scalable` (2nd Edition)ã® 16 ç« ã® `Parametrizing with Dynamic Values` ã« `pytest.param` ã®èª¬æ˜ãŒã‚ã‚‹ã€‚

* [Python Testing with pytest, 2nd Edition(amazon.co.jp)](https://www.amazon.co.jp/dp/B09X69NR1W/)
* [Python Testing with pytest, 2nd Edition ã®ç´¹ä»‹ã‚µã‚¤ãƒˆ](https://pythontest.com/pytest-book/)

æ³¨æ„: è³¼å…¥ã™ã‚‹å ´åˆã¯ã€åˆç‰ˆã¨ç¬¬2ç‰ˆã‚’é–“é•ãˆãªã„ã‚ˆã†ã«ã€‚

####  æ—¥æœ¬èªç‰ˆ

* [ãƒ†ã‚¹ãƒˆé§†å‹•Python ç¬¬2ç‰ˆ(amazon.co.jp)](https://www.amazon.co.jp/dp/4798177458)
* [ãƒ†ã‚¹ãƒˆé§†å‹•Python ç¬¬2ç‰ˆ(ç‰ˆå…ƒãƒ‰ãƒƒãƒˆã‚³ãƒ )](https://www.hanmoto.com/bd/isbn/9784798177458)



### ãƒ†ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸã„å ´åˆ

[pytest.param](https://docs.pytest.org/en/7.1.x/reference/reference.html?highlight=pytest%20param#pytest.param) ã¯ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§å¼•æ•°ã« [marks](https://docs.pytest.org/en/7.1.x/reference/reference.html?highlight=pytest%20mark%20xfail#marks) ã‚’ã¨ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

[pytest.mark.skipif](https://docs.pytest.org/en/7.1.x/reference/reference.html?#pytest-mark-skipif) ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ãƒ†ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ç†ç”±ã¨ã¨ã‚‚ã«æŒ‡å®šæ¡ä»¶ã§ãƒ†ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã§ãã‚‹ã€‚

```
def dynamic_params2():
    for i in range(3):
        for j in ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]:
            yield pytest.param(i, j, id=f"{i}-{j}-hoge", marks=pytest.mark.skipif(i % 2 ==0, reason="even"))

@pytest.mark.parametrize("i, j, ", dynamic_params2())
def test_dynamic_params2(i, j):
    print(i, j)
```


#### å‚è€ƒ

* [pytest.param](https://docs.pytest.org/en/7.1.x/reference/reference.html?#pytest-param)
* [pytest.mark.xfail](https://docs.pytest.org/en/7.1.x/reference/reference.html?#pytest-mark-xfail)
* [pytest.mark.skipif](https://docs.pytest.org/en/7.1.x/reference/reference.html?#pytest-mark-skipif)
* [pytest.mark.skip](https://docs.pytest.org/en/7.1.x/reference/reference.html?#pytest-mark-skip)