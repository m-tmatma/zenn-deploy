---
title: "GitHub CLI ã§ GitHub Actions ã®artifact ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹"
emoji: "ğŸ˜¸"
type: "tech"
topics:
  - "gh"
  - "githubcli"
published: true
published_at: "2023-01-07 09:42"
---

GitHub CLI ã§ GitHub Actions ã® artifact ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹

[gh run](https://cli.github.com/manual/gh_run) ã‚³ãƒãƒ³ãƒ‰ã® [list ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰](https://cli.github.com/manual/gh_run_list) ã¨  [download ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰](https://cli.github.com/manual/gh_run_download) ã‚’ä½¿ã£ã¦ã€artifact ã‚’åˆ—æŒ™ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚

â€» ã“ã“ã§ã¯ sakura editor ã‚’ä¾‹ã«èª¬æ˜ã™ã‚‹ã€‚

# çµè«–

å‡¦ç†å†…å®¹è‡ªä½“ã¯ sakura editor ã«ä¾å­˜ã—ã¦ã„ã‚‹ã®ã§ä½¿ç”¨ã—ãŸã„ãƒªãƒã‚¸ãƒˆãƒªã«å¿œã˜ã¦é©å®œã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŒå¿…è¦ã€‚

```
$ gh -R sakura-editor/sakura run download \
   $(gh -R sakura-editor/sakura run list \
   -L 1 -b master -w  "build sakura"  --json databaseId  --jq '.[].databaseId') \
   -p "*Installer*"
```

sakura editor ã®ä¾å­˜ã—ã¦ã„ã‚‹ã®ã¯ä»¥ä¸‹ã®éƒ¨åˆ†ã€‚ãã‚Œä»¥å¤–ã¯ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚æµç”¨å¯èƒ½ã€‚

* `-R sakura-editor/sakura` (ä½¿ç”¨ã—ãŸã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒ‡å®šã™ã‚‹)
* `-b master` (`main` ãƒ–ãƒ©ãƒ³ãƒã‚’ä½¿ç”¨ã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆã¯å¤‰æ›´å¿…è¦)
* `-w  "build sakura"` (ä½¿ç”¨ã—ãŸã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® workflow åã‚’æŒ‡å®šã™ã‚‹)
* `-p "*Installer*"` (ä½¿ç”¨ã—ãŸã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å–å¾—ã—ãŸã„ artifact åã‚’æŒ‡å®šã™ã‚‹)

# list ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰

## workflow ã®åˆ—æŒ™

* `gh run list` ã§ GitHub Actions ã® workflow ã‚’åˆ—æŒ™ã§ãã‚‹ã€‚
* è©²å½“ã®ãƒªãƒã‚¸ãƒˆãƒªå¤–ã§å®Ÿè¡Œã™ã‚‹å ´åˆã€`-R sakura-editor/sakura` ã§ãƒªãƒã‚¸ãƒˆãƒªã‚’æŒ‡å®šã™ã‚‹ã€‚
* è©²å½“ã®ãƒªãƒã‚¸ãƒˆãƒªå†…ã§å®Ÿè¡Œã™ã‚‹å ´åˆã€`-R sakura-editor/sakura` ã¯çœç•¥ã§ãã‚‹ã€‚
* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœ€å¤§ 30è¦ç´ è¡¨ç¤ºã™ã‚‹ã®ã§ `-L 5` ã®ã‚ˆã†ã«ã—ã¦åˆ—æŒ™ã™ã‚‹ä¸Šé™ã‚’è¨­å®šã§ãã‚‹ã€‚

```
$ gh -R sakura-editor/sakura run list -L 5
STATUS  TITLE                             WORKFLOW      BRANCH    EVENT                ID          ELAPSED  AGE
âœ“       ãƒ˜ãƒ«ãƒ—ã‚’UTF8ã®ã¾ã¾ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹  build sakura  utf8help  pull_request         3855650468  11m17s   10h
âœ“       ãƒ˜ãƒ«ãƒ—ã‚’UTF8ã®ã¾ã¾ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹  SonarCloud    utf8help  pull_request_target  3855650423  9m47s    10h
âœ“       SonarCloud                        SonarCloud    master    schedule             3853570129  12m8s    16h
âœ“       ãƒ˜ãƒ«ãƒ—ã‚’UTF8ã®ã¾ã¾ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹  SonarCloud    utf8help  pull_request_target  3846931454  7m44s    1d
âœ“       ãƒ˜ãƒ«ãƒ—ã‚’UTF8ã®ã¾ã¾ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹  build sakura  utf8help  pull_request         3846931433  10m32s   1d
```

## åˆ—æŒ™ ã™ã‚‹ workflow ã‚’é™å®š

* `-w  "build sakura"` ã§åˆ—æŒ™ã™ã‚‹ `WORKFLOW` ã‚’é™å®šã§ãã‚‹ã€‚
* `-b master` ã§åˆ—æŒ™ã™ã‚‹ `BRANCH` ã‚’é™å®šã§ãã‚‹ã€‚

```
$ gh -R sakura-editor/sakura run list -L 5 -b master -w  "build sakura"
STATUS  TITLE                                                                   WORKFLOW      BRANCH  EVENT  ID          ELAPSED  AGE
âœ“       Merge pull request #1893 from berryzplus/feature/remove_minidump        build sakura  master  push   3834956834  8m15s    2d
âœ“       Merge pull request #1888 from dep5/removePopup                          build sakura  master  push   3834127722  11m36s   2d
âœ“       Merge pull request #1887 from beru/HighDPI_CPropTypesColor__DrawColorâ€¦  build sakura  master  push   3804948023  9m55s    7d
âœ“       Merge pull request #1881 from dep5/setwidthimg                          build sakura  master  push   3798585802  12m19s   8d
âœ“       Merge pull request #1879 from dep5/build-chm-nopy                       build sakura  master  push   3798521306  8m23s    8d
```

# download ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰

## æŒ‡å®šã—ãŸworkflow ã® artifact ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

* `gh run download` ã§ GitHub Actions ã® artifact ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã€‚
* `3834956834` ã¯ `ID` ã‚’æŒ‡å®šã™ã‚‹ã€‚
* `â£·` ã®éƒ¨åˆ†ãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­æ›´æ–°ã•ã‚Œã¦é€²æ—ã‚’è¡¨ã™ã€‚å®Œäº†ã™ã‚‹ã¨æ¶ˆãˆã‚‹ã€‚

```
$ gh -R sakura-editor/sakura run download 3834956834
â£·
```

## ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ artifact ã‚’é™å®š

* `-p "*Installer*"` ã®ã‚ˆã†ã«æŒ‡å®šã™ã‚‹ã¨ artifact åã« `Installer` ã‚’å«ã‚€ã‚‚ã®ã®ã¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã€‚

```
$ gh -R sakura-editor/sakura run download 3834956834 -p "*Installer*"
```

# æœ€æ–°ã® artifact ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

list ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ã® `ID` ã®éƒ¨åˆ†ã‚’è§£æã—ã¦ã€download ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã«æ¸¡ã—ã¦ã‚„ã‚‹ã“ã¨ã§ã€æœ€æ–°ã® artifact ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚

## json å½¢å¼ã§å‡ºåŠ›ã—ã€å«ã‚ã‚‹è¦ç´ ã‚’æŒ‡å®š

* `--json databaseId` ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ json å½¢å¼ã§ `ID` ã®éƒ¨åˆ†ã®ã¿ã‚’å‡ºåŠ›ã™ã‚‹ã€‚

```
$ gh -R sakura-editor/sakura run list -L 5 -b master -w  "build sakura"  --json databaseId
[
  {
    "databaseId": 3834956834
  },
  {
    "databaseId": 3834127722
  },
  {
    "databaseId": 3804948023
  },
  {
    "databaseId": 3798585802
  },
  {
    "databaseId": 3798521306
  }
]
```

## json å½¢å¼ã®çµæœã‚’ `jq` ã‚’ä½¿ç”¨ã—ã¦å–ã‚Šå‡ºã—

* `--jq '.[].databaseId'` ã‚’æŒ‡å®šã—ã¦ã€é…åˆ—è¦ç´ ã®ä¸­ã® `databaseId` ã®éƒ¨åˆ†ã®ã¿ã‚’å–ã‚Šå‡ºã™ã€‚

```
$ gh -R sakura-editor/sakura run list \
-L 5 -b master -w  "build sakura"  --json databaseId  --jq '.[].databaseId'
3834956834
3834127722
3804948023
3798585802
3798521306
```

## æœ€æ–°ã® workflow ã® ID ã‚’å–å¾—

`-L 1` ã‚’æŒ‡å®šã—ã¦æœ€æ–°ã®ã‚‚ã®ã ã‘å–ã‚Šå‡ºã™ã€‚

```
$ gh -R sakura-editor/sakura run list \
-L 1 -b master -w  "build sakura"  --json databaseId  --jq '.[].databaseId'
3834956834
```

## å‚è€ƒ: json å½¢å¼ã§æŒ‡å®šã§ãã‚‹è¦ç´ 

* `--json` ã‚’å¼•æ•°ãªã—ã§æŒ‡å®šã™ã‚‹ã¨æŒ‡å®šå¯èƒ½ãªå€¤ã‚’è¡¨ç¤ºã™ã‚‹ã€‚

```
$ gh -R sakura-editor/sakura run list  --json
Specify one or more comma-separated fields for `--json`:
  conclusion
  createdAt
  databaseId
  displayTitle
  event
  headBranch
  headSha
  name
  number
  startedAt
  status
  updatedAt
  url
  workflowDatabaseId
  workflowName
```


## æœ€æ–°ã® workflow ã® ID ã® artifact ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚

ã“ã‚Œã¾ã§ã®æ‰‹é †ã‚’ã¾ã¨ã‚ã¦ã€ä»¥ä¸‹ã§æœ€æ–°ã® `Installer` ã‚’å«ã‚€ artifact ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã€‚

```
$ gh -R sakura-editor/sakura run download \
   $(gh -R sakura-editor/sakura run list \
   -L 1 -b master -w  "build sakura"  --json databaseId  --jq '.[].databaseId') \
   -p "*Installer*"
```