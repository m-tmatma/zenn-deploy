---
title: "python ä»®æƒ³ç’°å¢ƒ"
emoji: "ğŸ”–"
type: "tech"
topics:
  - "python"
  - "ä»®æƒ³ç’°å¢ƒ"
  - "venv"
published: true
published_at: "2022-02-19 19:17"
---

# python ä»®æƒ³ç’°å¢ƒ

ã“ã®è¨˜äº‹ã§ã¯ ubuntu 21.04 ã‚’ãƒ™ãƒ¼ã‚¹ã«èª¬æ˜ã—ã¾ã™ã€‚

## python ã®å®Ÿè¡Œç’°å¢ƒ

python ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ãŸã„å ´åˆã€å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãƒ†ã‚¹ãƒˆã—ã¾ã™ãŒã€
ã©ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‹ã€ã„ã¡ã„ã¡æ‰‹é †ã‚’è¨˜éŒ²ã—ãŸã‚Šã¨ã‹ã—ã¦ã„ã‚‹ã¨é¢å€’ã ã—
æ‰‹é †ã®è¨˜éŒ²ãŒæ¼ã‚Œã¦ã„ãŸã‚Šã™ã‚‹ã¨å†ç¾ã§ããªã‹ã£ãŸã‚Šã—ã¾ã™ã€‚

æœ€è¿‘ã§ã¯ Docker ã‚’åˆ©ç”¨ã—ã¦ Dockerfile ã«ç’°å¢ƒã‚’è¨˜è¼‰ã—ã¦ã€docker image ã‚’å…±é€šã§ä½¿ã†ã“ã¨ã«ã‚ˆã‚Šç’°å¢ƒã‚’çµ±ä¸€ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Docker ã¯ã„ã‚ã„ã‚ã‚ã‚“ã©ãã•ã„ã¨ã“ã‚ã‚‚ã‚ã‚‹ã®ã§ã€ python é™å®šã§ä»®æƒ³ç’°å¢ƒã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šãƒ›ã‚¹ãƒˆç’°å¢ƒã«ã‚ã¾ã‚Šå½±éŸ¿ã•ã‚Œãšã« [ä»®æƒ³ç’°å¢ƒ](https://docs.python.org/ja/3.9/tutorial/venv.html) ã‚’ä½œã‚‹æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã®è¨˜äº‹ã®å†…å®¹ã¨ã»ã¼åŒã˜ã§ã™ãŒã€è‡ªåˆ†ã§ã‚„ã£ã¦ã¿ãŸè¨˜éŒ²ã§ã™ã€‚

http://hydro.iis.u-tokyo.ac.jp/~akira/page/Python/contents/environment/virtualEnvironment.html


## æº–å‚™

python ã® `venv` ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚(python ã‚‚ä¸€ç·’ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™)

```
sudo apt install -y python3-venv
```

## ä»®æƒ³ç’°å¢ƒã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« + ä»®æƒ³ç’°å¢ƒåŒ–ã§å®Ÿè¡Œ

`test.sh`

```
#!/bin/bash

ENV_NAME=envtest

python3 -m venv $ENV_NAME
source $ENV_NAME/bin/activate
python3 -m pip install pytest pytest-mock
pytest -vv .
```

## è§£èª¬

`python3 -m venv envtest` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã« `envtest` ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã¾ã™ã€‚ã“ã®ä¸­ã«ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ç¾¤ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™ã€‚é€†ã«ã„ã†ã¨ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä¸€æ‹¬ã§å‰Šé™¤ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ç’°å¢ƒã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

`source envtest/bin/activate` ã‚’è¡Œã†ã“ã¨ã«ã‚ˆã‚Šã€ä»®æƒ³ç’°å¢ƒã®ã‚·ã‚§ãƒ«ã‚’æº–å‚™ã—ã¦ã„ã¾ã™ã€‚
`source` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã®ã§ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å…ˆé ­ã§ã€`#!/bin/bash` ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚

`source envtest/bin/activate` ã‚’è¡Œã†ã¨ã€ã“ã‚Œä»¥é™ã¯æ°—ã«ã›ãšã« ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã„ã¾ã™ã€‚

### å‚™è€ƒ

`python3 -m venv /tmp/envtest` ã¨ã—ã¦ç’°å¢ƒã‚’ä½œæˆã™ã‚‹ã¨ `/tmp/envtest` ä»¥ä¸‹ã«ç’°å¢ƒã‚’ä½œã‚Šã¾ã™ã€‚

## ãƒ›ã‚¹ãƒˆç’°å¢ƒã®ç¢ºèª

`test.sh` ã‚’å®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã‚’å®Ÿè¡Œã™ã‚‹ã¨ `pytest` ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ã€‚

```
$ python3
Python 3.9.5 (default, Nov 18 2021, 16:00:48)
[GCC 10.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import pytest
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ModuleNotFoundError: No module named 'pytest'
>>>
```

## å‚è€ƒãƒªãƒ³ã‚¯

http://hydro.iis.u-tokyo.ac.jp/~akira/page/Python/contents/environment/virtualEnvironment.html


https://docs.python.org/ja/3.9/tutorial/venv.html